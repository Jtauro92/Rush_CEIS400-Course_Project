from msvcrt import getwch
from os import system, name
from user_signon import UserSignOn as uso


clear_console = lambda: system('cls' if name == 'nt' else 'clear')

class MainMenu:
    def __init__(self):
        self.admin_account = uso().sign_on()
        self._jobs = ["1. View Inventory",
                     "2. Check-in Item",
                     "3. Check-out Item",
                     "0. Exit"
        ]
        
        if self.admin_account:
            self._jobs.insert(3, "4. Add Employee")
            self._jobs.insert(4, "5. Terminate Employee")


    def __str__(self):
        clear_console()

        menu_str = "Admin Menu:\n" if self.admin_account else "Main Menu:\n"
        
        menu_str += '\n'.join(self._jobs)
        return menu_str
            
    def select_option(self):
        def navigation():
                key = getwch()  # Get the actual key code
                if key == 'H':
                    return 'up'
                elif key == 'P':
                    return 'down'
                elif key == '\r':
                    return '\r'        
        index = 0
        while True:
            
            self._jobs[index] = f"> {self._jobs[index]} <"
            print(self)
            self._jobs[index] = self._jobs[index].strip("> <")
            action = navigation()

            if action == 'up' and index > 0:
                index -= 1
            elif action == 'down' and index < len(self._jobs) - 1:
                index += 1
            if action == '\r':
                return index

    def process_selection(self):
        selection = self.select_option()
        if selection == 0:
            print("Viewing Inventory...")
        elif selection == 1:
            print("Checking-in Item...")
        elif selection == 2:
            print("Checking-out Item...")
        elif selection == 3 and self.admin_account:
            print("Adding Employee...")
        elif selection == 4 and self.admin_account:
            print("Terminating Employee...")
        elif (selection == 5 and self.admin_account) or (selection == 3 ):
            print("Exiting...")
            exit()
            

class AdminMenu:
    pass

if __name__ == "__main__":
    menu = MainMenu()
    menu.process_selection()